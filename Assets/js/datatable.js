/*!
 *
 * Vanilla-DataTables
 * Copyright (c) 2015-2017 Karl Saunders (http://mobius.ovh)
 * Licensed under MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 * Version: 2.0.0-beta.1
 *
 */
!function(e,t){var n="DataTable";"object"==typeof exports?module.exports=t(n):"function"==typeof define&&define.amd?define([],t(n)):e[n]=t(n)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";var t=window,n=document,a=n.body,s="classList"in a,i=!!/(msie|trident)/i.test(navigator.userAgent),r={perPage:10,perPageSelect:[5,10,15,20,25],sortable:!0,searchable:!0,nextPrev:!0,firstLast:!1,prevText:"&lsaquo;",nextText:"&rsaquo;",firstText:"&laquo;",lastText:"&raquo;",ellipsisText:"&hellip;",truncatePager:!0,pagerDelta:2,fixedColumns:!0,fixedHeight:!1,header:!0,footer:!1,search:{includeHiddenColumns:!1},classes:{top:"dt-top",info:"dt-info",input:"dt-input",table:"dt-table",bottom:"dt-bottom",search:"dt-search",sorter:"dt-sorter",wrapper:"dt-wrapper",dropdown:"dt-dropdown",ellipsis:"dt-ellipsis",selector:"dt-selector",container:"dt-container",pagination:"dt-pagination"},labels:{placeholder:"Search...",perPage:"{select} entries per page",noRows:"No entries found",info:"Showing {start} to {end} of {rows} entries"},layout:{top:"{select}{search}",bottom:"{info}{pager}"}},o=["editable","exportable","filterable"],l=function(e){return"[object Object]"===Object.prototype.toString.call(e)},c=function(e){return Array.isArray(e)},d=function(e){var t=!1;try{t=JSON.parse(e)}catch(e){return!1}return!(null===t||!c(t)&&!l(t))&&t},h=function(e,t){return e.hasOwnProperty(t)},u=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];a&&l(a)?(e[n]=e[n]||{},u(e[n],a)):e[n]=a}return e},p=function(e,t,n){var a;if(l(e))for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(n,e[a],a);else if(c(e))for(a=0;a<e.length;a++)t.call(n,e[a],a);else for(a=0;a<e;a++)t.call(n,a+1,a)},f=function(e,t){var a=n.createElement(e);if(t&&"object"==typeof t){var s;for(s in t)"html"===s?a.innerHTML=t[s]:s in a?a[s]=t[s]:a.setAttribute(s,t[s])}return a},g=function(e,t,n){e.addEventListener(t,n,!1)},v=function(e){if(i)for(;e.hasChildNodes();)e.removeChild(e.lastChild);else e.innerHTML=""},m={add:function(e,t){s?e.classList.add(t):m.contains(e,t)||(e.className=e.className.trim()+" "+t)},remove:function(e,t){s?e.classList.remove(t):m.contains(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," "))},contains:function(e,t){return s?e.classList.contains(t):!!e.className&&!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},toggle:function(e,t,n){t+="";var a=this.contains(e,t),s=a?!0!==n&&"remove":!1!==n&&"add";return s&&this[s](e,t),!0===n||!1===n?n:!a}},b={each:p,extend:u,isObject:l,classList:m,createElement:f},w=function(e,n,a,s){var i=!1;if(n&&t.moment)switch(n){case"ISO_8601":i=moment(e,moment.ISO_8601).format("YYYYMMDD");break;case"RFC_2822":i=moment(e,"ddd, DD MMM YYYY HH:mm:ss ZZ").format("YYYYMMDD");break;case"MYSQL":i=moment(e,"YYYY-MM-DD hh:mm:ss").format("YYYYMMDD");break;case"UNIX":i=moment(parseInt(e,10)).unix();break;default:i=moment(e,n).format("YYYYMMDD")}else i=new Date(e).getTime();return i},x=function(e,t){this.node=e,this.content=this.originalContent=e.innerHTML,this.hidden=!1,this.index=this.node.dataIndex=t,this.originalContent=this.content};x.prototype.setContent=function(e){this.content=this.node.innerHTML=e};var y=function(e,t){c(e)?(this.node=f("tr"),p(e,function(e,t){this.node.appendChild(f("td",{html:e}))},this)):(this.node=e,void 0!==t&&(this.isHeader="THEAD"===e.parentNode.nodeName)),this.isHeader||void 0===t||(this.index=this.node.dataIndex=t-1),this.cells=[].slice.call(this.node.cells).map(function(e,t){return new x(e,t,this)},this)},C=function(e,t,a){if(this.node=e,"string"==typeof e&&(this.node=n.querySelector(e)),t&&this.build(t),this.rows=[].slice.call(this.node.rows).map(function(e,t){return new y(e,t,this)},this),this.body=this.node.tBodies[0],this.body||(this.body=f("tbody"),this.node.appendChild(this.body)),this.rows.length&&(this.rows[0].isHeader?(this.hasHeader=!0,this.header=this.rows[0],this.head=this.header.node.parentNode,this.rows.shift(),a.config.sortable&&p(this.header.cells,function(e){m.add(e.node,a.config.classes.sorter)})):this.addHeader()),a.config.header||this.head.removeChild(this.header.node),a.config.footer){this.hasFooter=!0,this.footer=new y(this.header.node.cloneNode(!0));var s=f("tfoot");s.appendChild(this.footer.node),p(this.footer.cells,function(e){m.remove(e.node,a.config.classes.sorter)}),this.node.insertBefore(s,this.body)}};C.prototype={build:function(e){var t=!1,n=!1;if(e.headings){t=f("thead");var a=f("tr");p(e.headings,function(e){var t=f("th",{html:e});a.appendChild(t)}),t.appendChild(a)}e.data&&e.data.length&&(n=f("tbody"),p(e.data,function(e){var t=f("tr");p(e,function(e){var n=f("td",{html:e});t.appendChild(n)}),n.appendChild(t)})),t&&(null!==this.node.tHead&&this.node.removeChild(this.node.tHead),this.node.appendChild(t)),n&&(this.node.tBodies.length&&this.node.removeChild(this.node.tBodies[0]),this.node.appendChild(n))},addHeader:function(){var e=f("thead"),t=f("tr");p(this.rows[0].cells,function(e){t.appendChild(f("td"))}),e.appendChild(t),this.head=e,this.header=new y(t,1),this.hasHeader=!0},addRow:function(e,t,n){if(e instanceof y)return this.rows.splice(t||0,0,e),this.hasHeader||this.addHeader(),n&&this.update(),e},removeRow:function(e,t){e instanceof y&&(this.rows.splice(this.rows.indexOf(e),1),t&&this.update())},update:function(e){p(this.rows,function(e,t){e.index=e.node.dataIndex=t})}};var P=function(e,t){this.instance=e,this.parent=t};P.prototype={render:function(e){var t=this,n=t.instance,a=n.config;if(e=e||n.totalPages,v(t.parent),e>1){var s="pager",i=f("ul"),r=n.onFirstPage?1:n.currentPage-1,o=n.onlastPage?e:n.currentPage+1;a.firstLast&&i.appendChild(t.button(s,1,a.firstText)),a.nextPrev&&i.appendChild(t.button(s,r,a.prevText));var l=t.truncate();p(l,function(e){i.appendChild(e)}),a.nextPrev&&i.appendChild(t.button(s,o,a.nextText)),a.firstLast&&i.appendChild(t.button(s,e,a.lastText)),t.parent.appendChild(i)}},truncate:function(){var e,t=this,n=t.instance.config,a=2*n.pagerDelta,s=t.instance.currentPage,i=s-n.pagerDelta,r=s+n.pagerDelta,o=t.instance.totalPages,l=[],c=[];if(n.truncatePager){s<4-n.pagerDelta+a?r=3+a:s>o-(3-n.pagerDelta+a)&&(i=o-(2+a));for(var d=1;d<=o;d++)(1==d||d==o||d>=i&&d<=r)&&l.push(d);p(l,function(a){e&&(a-e==2?c.push(t.button("",e+1,e+1)):a-e!=1&&c.push(t.button(n.classes.ellipsis,0,n.ellipsisText,!0))),c.push(t.button(a==s?"active":"",a,a)),e=a})}else p(o,function(e){c.push(t.button(e==s?"active":"",e,e))});return c},button:function(e,t,n,a){return f("li",{class:e,html:a?"<span>"+n+"</span>":'<a href="#" data-page="'+t+'">'+n+"</a>"})}};var D=function(e){this.instance=e};D.prototype={init:function(){},count:function(){return this.instance.table.rows.length},render:function(e){var t=this.instance;if(e=e||t.currentPage,v(t.table.body),!(e<1||e>t.totalPages)){var a=t.table.header,s=n.createDocumentFragment();t.table.hasHeader&&(v(a.node),p(a.cells,function(e){e.hidden||a.node.appendChild(e.node)})),t.pages.length&&p(t.pages[e-1],function(e){v(e.node),p(e.cells,function(t){t.hidden||e.node.appendChild(t.node)}),s.append(e.node)}),t.table.body.appendChild(s),p(t.pagers,function(e){e.render()}),t.getInfo(),t.emit("rows.render")}},paginate:function(){var e=this.instance.config,t=this.instance.table.rows,n=this.instance;n.searching&&n.searchData&&(t=n.searchData),n.pages=t.map(function(n,a){return a%e.perPage==0?t.slice(a,a+e.perPage):null}).filter(function(e){return e}),n.totalPages=n.pages.length,n.currentPage>n.totalPages&&(n.currentPage=n.totalPages)},add:function(e,t){if(c(e))return t=t||0,c(e[0])?(p(e,function(e){e=this.instance.table.addRow(new y(e,this.instance.columns().count()+1),t)},this),this.instance.table.update()):e=this.instance.table.addRow(new y(e,this.instance.columns().count()+1),t,!0),this.instance.update(),e},remove:function(e){var t=!1,n=this.instance;if(c(e)){for(var a=e.length-1;a>=0;a--)n.table.removeRow(this.get(e[a]));n.table.update(),n.update()}else if(t=this.get(e))return n.table.removeRow(t,!0),n.update(),t},get:function(e){var t=this.instance.table.rows;if(e instanceof y||e instanceof Element){for(var n=0;n<t.length;n++)if(t[n].node===e||t[n]===e){e=t[n];break}}else e=t[e];return e}};var H=function(e){this.instance=e};H.prototype={init:function(){},count:function(){return this.instance.table.header.cells.length},sort:function(e,t){var n=this.instance;if(e=e||0,t=t||(t=n.lastDirection&&"asc"===n.lastDirection?"desc":"asc"),e<0||e>n.table.header.cells.length-1)return!1;var a=n.table.header.cells[e].node,s=n.table.rows;n.searching&&n.searchData&&(s=n.searchData),n.lastHeading&&m.remove(n.lastHeading,n.lastDirection),n.lastDirection&&m.remove(a,n.lastDirection),m.add(a,t);var i,r;a.hasAttribute("data-type")&&"date"===a.getAttribute("data-type")&&(i=!1,(r=a.hasAttribute("data-format"))&&(i=a.getAttribute("data-format"))),s.sort(function(n,a){var s=n.cells[e].content,o=a.cells[e].content;return r?(s=w(s,i,n.cells[e]),o=w(o,i,a.cells[e])):(s=s.replace(/(\$|\,|\s|%)/g,""),o=o.replace(/(\$|\,|\s|%)/g,"")),s=isNaN(s)?s:parseInt(s,10),o=isNaN(o)?o:parseInt(o,10),"asc"===t?s>o:s<o}),n.table.update(),n.update(),n.lastHeading=a,n.lastDirection=t,n.emit("columns.sort",t,e,a),m.remove(a,"loading")},filter:function(e,t){this.instance.search(t,e)},order:function(e){var t=this.instance;if(c(e)){for(var n=0;n<e.length;n++)if(e[n]>=t.columns().count())throw new Error("Column index "+e[n]+" is outside the range of columns.");var a=function(t){var n=[];p(e,function(e,a){n[a]=t.cells[e],n[a].index=n[a].node.dataIndex=a,t.node.appendChild(n[a].node)}),t.cells=n};t.table.hasHeader&&a(t.table.header),t.table.hasFooter&&a(t.table.footer),p(t.table.rows,function(e){a(e)}),t.update(),t.emit("columns.order",e)}},hide:function(e){var t=this.instance,n=t.table.header,a=t.table.rows;isNaN(e)||(e=[e]),p(e,function(e){p(n.cells,function(t){e==t.index&&(t.hidden=!0)}),p(a,function(t){p(t.cells,function(t){e==t.index&&(t.hidden=!0)})})}),this.fix(!0),t.update(),t.emit("columns.hide",e)},show:function(e){var t=this.instance,n=t.table.header,a=t.table.rows;isNaN(e)||(e=[e]),p(e,function(e){p(n.cells,function(t){e==t.index&&(t.hidden=!1)}),p(a,function(t){p(t.cells,function(t){e==t.index&&(t.hidden=!1)})})}),this.fix(!0),t.update(),t.emit("columns.show",e)},visible:function(e){var t,n=this.instance.table.header;return void 0===e&&(e=n.cells.map(function(e){return e.index})),isNaN(e)?c(e)&&(t=[],p(e,function(e){t.push(!n.cells[e].hidden)})):t=!n.cells[e].hidden,t},add:function(e){var t=this.instance;if(l(e)){if(h(e,"heading")){var n=new x(f("th"),t.columns().count());n.setContent(e.heading),t.table.header.node.appendChild(n.node),t.table.header.cells.push(n)}h(e,"data")&&c(e.data)&&p(t.table.rows,function(t,n){var a=new x(f("td"),t.cells.length);a.setContent(e.data[n]||""),t.node.appendChild(a.node),t.cells.push(a)})}this.fix(!0),t.update(),t.emit("columns.add")},remove:function(e,t){var n=this.instance,a=n.table,s=a.header;if(c(e))return e.sort(function(e,t){return t-e}),void p(e,function(t,n){this.remove(t,n<e.length-1)},this);s.node.removeChild(s.cells[e].node),s.cells.splice(e,1),p(a.rows,function(t){t.node.removeChild(t.cells[e].node),t.cells.splice(e,1)}),t||(p(s.cells,function(e,t){e.index=e.node.dataIndex=t}),p(a.rows,function(e){p(e.cells,function(e,t){e.index=e.node.dataIndex=t})}),this.fix(!0),n.update()),n.emit("columns.remove",e)},fix:function(e){var t=this.instance,n=t.table,a=n.header;e&&n.hasHeader&&t.config.fixedColumns&&(t.columnWidths=a.cells.map(function(e){return e.node.offsetWidth})),p(t.columnWidths,function(e,n){a.cells[n].node.style.width=e/t.rect.width*100+"%"})}};var N=function(e,t){if(this.config=u(r,t),this.API={rows:new D(this),columns:new H(this)},this.config.ajax){var n=this,a=this.config.ajax;this.request=new XMLHttpRequest,g(this.request,"load",function(t){if(4===n.request.readyState&&200===n.request.status){var s={};s.data=a.load?a.load.call(n,n.request):n.request.responseText,s.type="json",a.content&&a.content.type&&(s.type=a.content.type,s=u(s,a.content)),n.table=new C(e,s.data,n),n.init()}}),this.request.open("GET","string"==typeof a?n.config.ajax:n.config.ajax.url),this.request.send()}else this.config.data?this.table=new C(e,this.config.data,this):this.table=new C(e,!1,this),this.init()};return N.prototype={init:function(){if(!this.initialised){var e=this,t=e.config;if(e.currentPage=1,e.onFirstPage=!0,e.onLastPage=!1,e.rows().paginate(),e.totalPages=e.pages.length,e.render(),t.fixedColumns&&e.columns().fix(),e.extend(),t.plugins&&p(t.plugins,function(t,n){void 0!==e[n]&&"function"==typeof e[n]&&(e[n]=e[n](e,t,b),t.enabled&&e[n].init&&"function"==typeof e[n].init&&e[n].init())}),t.columns){var n=[],a=[];p(t.columns,function(s){c(s.select)||(s.select=[s.select]),h(s,"render")&&"function"==typeof s.render&&(n=n.concat(s.select),a.push({columns:s.select,renderer:s.render})),e.table.hasHeader&&p(s.select,function(n){var a=e.table.header.cells[n];s.type&&a.node.setAttribute("data-type",s.type),s.format&&a.node.setAttribute("data-format",s.format),h(s,"sortable")&&(a.node.setAttribute("data-sortable",s.sortable),!1===s.sortable&&m.remove(a.node,t.classes.sorter)),h(s,"hidden")&&!1!==s.hidden&&e.columns().hide(n),h(s,"sort")&&1===s.select.length&&e.columns().sort(s.select[0],s.sort)})}),n.length&&p(e.table.rows,function(t){p(t.cells,function(s){n.indexOf(s.index)>=0&&p(a,function(n){n.columns.indexOf(s.index)>=0&&s.setContent(n.renderer.call(e,s.content,s,t))})})})}e.rows().render(),e.bindEvents(),e.initialised=!0,setTimeout(function(){e.API.rows.init(),e.API.columns.init(),e.emit("init")},10)}},extend:function(){var e=this;p(o,function(t){void 0!==e[t]&&"function"==typeof e[t]&&(e[t]=e[t](e,e.config[t],b),e[t].init&&"function"==typeof e[t].init&&e[t].init())})},bindEvents:function(){var e=this,t=e.config;g(e.wrapper,"mousedown",function(e){1===e.which&&t.sortable&&"TH"===e.target.nodeName&&m.add(e.target,"loading")}),g(e.wrapper,"click",function(n){var a=n.target;if(a.hasAttribute("data-page")&&(n.preventDefault(),e.page(parseInt(a.getAttribute("data-page"),10))),t.sortable&&"TH"===a.nodeName&&m.contains(a,t.classes.sorter)){if(a.hasAttribute("data-sortable")&&"false"===a.getAttribute("data-sortable"))return!1;n.preventDefault(),e.columns().sort(a.dataIndex,m.contains(a,"asc")?"desc":"asc")}}),t.perPageSelect&&g(e.wrapper,"change",function(n){var a=n.target;"SELECT"===a.nodeName&&m.contains(a,t.classes.selector)&&(n.preventDefault(),e.config.perPage=parseInt(a.value,10),e.selectors.length>1&&p([].slice.call(e.selectors),function(e){e.selectedIndex=a.selectedIndex}),e.update())}),t.searchable&&g(e.wrapper,"keyup",function(n){"INPUT"===n.target.nodeName&&m.contains(n.target,t.classes.input)&&(n.preventDefault(),e.search(n.target.value))}),t.sortable&&g(e.wrapper,"mousedown",function(e){"TH"===e.target.nodeName&&e.preventDefault()})},render:function(){if(!this.rendered){var e=this,t=e.config;this.table.hasHeader&&t.fixedColumns&&t.header&&(this.columnWidths=this.table.header.cells.map(function(e){return e.node.offsetWidth})),e.wrapper=f("div",{class:t.classes.wrapper});var n=["<div class='",t.classes.top,"'>",t.layout.top,"</div>","<div class='",t.classes.container,"'></div>","<div class='",t.classes.bottom,"'>",t.layout.bottom,"</div>"].join("");if(n=n.replace("{info}","<div class='"+t.classes.info+"'></div>"),t.perPageSelect){var a=["<div class='",t.classes.dropdown,"'>","<label>",t.labels.perPage,"</label>","</div>"].join(""),s=f("select",{class:t.classes.selector});p(t.perPageSelect,function(e){var n=e===t.perPage,a=new Option(e,e,n,n);s.add(a)}),a=a.replace("{select}",s.outerHTML),n=n.replace(/\{select\}/g,a)}else n=n.replace(/\{select\}/g,"");if(t.searchable){var i=["<div class='",t.classes.search,"'>","<input class='",t.classes.input,"' placeholder='",t.labels.placeholder,"' type='text'>","</div>"].join("");n=n.replace(/\{search\}/g,i)}else n=n.replace(/\{search\}/g,"");e.table.node.classList.add(t.classes.table),p(n.match(/\{pager\}/g),function(e,a){n=n.replace("{pager}",f("div",{class:t.classes.pagination}).outerHTML)}),e.wrapper.innerHTML=n,e.pagers=[].slice.call(e.wrapper.querySelectorAll("."+t.classes.pagination)),p(e.pagers,function(t,n){e.pagers[n]=new P(e,t)}),e.container=e.wrapper.querySelector("."+t.classes.container),e.labels=e.wrapper.querySelectorAll("."+t.classes.info),e.inputs=e.wrapper.querySelectorAll("."+t.classes.input),e.selectors=e.wrapper.querySelectorAll("."+t.classes.selector),e.table.node.parentNode.replaceChild(e.wrapper,e.table.node),e.container.appendChild(e.table.node),e.rect=e.table.node.getBoundingClientRect(),e.rendered=!0}},update:function(){this.rows().paginate(),this.rows().render(),this.emit("update")},getInfo:function(){var e,t=0,n=0,a=0;if(this.totalPages&&(a=(n=(t=this.currentPage-1)*this.config.perPage)+this.pages[t].length,n+=1,e=this.searching?this.searchData.length:this.rows().count()),this.labels.length&&this.config.labels.info.length){var s=this.config.labels.info.replace("{start}",n).replace("{end}",a).replace("{page}",this.currentPage).replace("{pages}",this.totalPages).replace("{rows}",e);p([].slice.call(this.labels),function(t){t.innerHTML=e?s:""})}},search:function(e,t){var n=this;if(e=e.toLowerCase(),n.currentPage=1,n.searching=!0,n.searchData=[],!e.length)return n.searching=!1,m.remove(n.wrapper,"search-results"),n.update(),!1;p(n.table.rows,function(a){var s=n.searchData.indexOf(a)>=0;void 0!==t?p(a.cells,function(i){void 0===t||i.index!=t||s||i.content.toLowerCase().indexOf(e)>=0&&n.searchData.push(a)}):e.split(" ").reduce(function(e,t){for(var s=!1,i=0;i<a.cells.length;i++)if(a.cells[i].content.toLowerCase().indexOf(t)>=0){(!a.cells[i].hidden||a.cells[i].hidden&&n.config.search.includeHiddenColumns)&&(s=!0);break}return e&&s},!0)&&!s&&n.searchData.push(a)}),m.add(n.wrapper,"search-results"),n.searchData.length?n.update():(m.remove(n.wrapper,"search-results"),n.setMessage(n.config.labels.noRows)),this.emit("search",e,this.searchData)},page:function(e){return e!=this.currentPage&&(isNaN(e)||(this.currentPage=parseInt(e,10)),this.onFirstPage=1===this.currentPage,this.onLastPage=this.currentPage===this.totalPages,!(e>this.totalPages||e<0)&&(this.rows().render(e),void this.emit("page",e)))},reset:function(){this.searching&&(this.searching=this.searchData=!1,m.remove(this.wrapper,"search-results")),p([].slice.call(this.inputs),function(e){e.value=null,e.blur()}),this.update(),this.emit("reset")},import:function(e){var t=this,n=!1,a={lineDelimiter:"\n",columnDelimiter:","};if(!l(e))return!1;if((e=u(a,e)).data.length||l(e.data)){if("csv"===e.type){n={data:[]};var s=e.data.split(e.lineDelimiter);s.length&&(e.headings&&(n.headings=s[0].split(e.columnDelimiter),s.shift()),p(s,function(t,a){n.data[a]=[];var s=t.split(e.columnDelimiter);s.length&&p(s,function(e){n.data[a].push(e)})}))}else if("json"===e.type){var i=d(e.data);if(!i)throw new Error("That's not valid JSON!");n={headings:[],data:[]},p(i,function(e,t){n.data[t]=[],p(e,function(e,a){n.headings.indexOf(a)<0&&n.headings.push(a),n.data[t].push(e)})})}l(e.data)&&(n=e.data),n&&(p(n.headings,function(e,n){t.table.header.cells[n].setContent(e)}),this.rows().add(n.data))}return!1},setMessage:function(e){var t=1;this.rows().count()&&(t=this.columns().count());var n=f("tr",{html:'<td class="dataTables-empty" colspan="'+t+'">'+e+"</td>"});v(this.table.body),this.table.body.appendChild(n)},columns:function(){return this.API.columns},rows:function(){return this.API.rows},on:function(e,t){this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t)},off:function(e,t){this.events=this.events||{},e in this.events!=!1&&this.events[e].splice(this.events[e].indexOf(t),1)},emit:function(e){if(this.events=this.events||{},e in this.events!=!1)for(var t=0;t<this.events[e].length;t++)this.events[e][t].apply(this,Array.prototype.slice.call(arguments,1))},destroy:function(){var e=this,t=e.config,a=e.table;m.remove(a.node,t.classes.table),p(a.header.cells,function(e){e.node.style.width="",m.remove(e.node,t.classes.sorter)});var s=n.createDocumentFragment();v(a.body),p(a.rows,function(e){s.appendChild(e.node)}),a.body.appendChild(s),this.wrapper.parentNode.replaceChild(a.node,this.wrapper),this.rendered=!1,this.initialised=!1}},N.extend=function(e,t){"function"==typeof t?N.prototype[e]=t:N[e]=t},N});

/*! Exportable 0.0.10
 * © 2017 Karl Saunders
 */
/**
 * @summary     Exportable
 * @description Vanilla-DataTables extension to allow for exporting to various formats
 * @version     0.0.10
 * @file        datatable.exportable.js
 * @author      Karl Saunders
 * @contact     mobius1@gmx.com
 * @copyright   Copyright 2017 Karl Saunders
 *
 *
 * This source file is free software, available under the following license:
 *   MIT license - https://github.com/Mobius1/Vanilla-DataTables/blob/master/LICENSE
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: https://github.com/Mobius1/Vanilla-DataTables
 */
window.DataTable&&DataTable.extend("exportable",function(e,t,n){var i={download:!0,skipColumns:[],escapeHTML:!0,lineDelimiter:"\n",columnDelimiter:",",includeHeadings:!0,columnize:!1,paddingCharacter:" ",tableName:"table",replacer:null,space:4,rootNode:"Root",childNode:"Child",modal:!0},o=function(){};return o.prototype.init=function(){this.initialised||(this.config=n.extend(i,t),this.initialised=!0)},o.prototype.getRows=function(t){var i=[];return(t=t||this.config).pages?isNaN(t.pages)?Array.isArray(t.pages)&&n.each(t.pages,function(t){i=i.concat(e.pages[t-1])}):i=i.concat(e.pages[t.pages-1]):i=i.concat(e.table.rows),i},o.prototype.getConfig=function(e){return e&&n.isObject(e)?n.extend(n.extend({},this.config),e):this.config},o.prototype.stripHTML=function(e){return e.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?(\/)?>|<\/\w+>/gi,"")},o.prototype.parseXMLTag=function(e){return(e=e.charAt(0).toUpperCase()+e.slice(1)).replace(/\.|\s+/g,"")},o.prototype.export=function(e){switch((e=this.getConfig(e)).type.toLowerCase()){case"json":this.toJSON(e);break;case"sql":this.toSQL(e);break;case"csv":this.toCSV(e)}},o.prototype.columnize=function(e,t){var i=[];return n.each(e.strings,function(o,a){i[a]=[],n.each(o,function(n,o){if(i[a][o]=n,n.length<e.lengths[o])for(var c=e.lengths[o]-n.length,s=0;s<c;s++)i[a][o]+=t})}),i},o.prototype.toText=function(t){(t=this.getConfig(t)).type="txt";var i="",o=[],a=t,c=e.table,s=this.getRows(a),l=[],r=[];return t.includeHeadings&&s.unshift(c.header),n.each(s,function(e,o){if(t.columnize&&!r.length)for(var a=0;a<e.cells.length;a++)r[a]=0;l[o]=[],n.each(e.cells,function(e,n){i=e.content.trim(),l[o][n]=i,t.columnize&&i.length>r[n]&&(r[n]=i.length)})}),o=t.columnize?this.columnize({lengths:r,strings:l},t.paddingCharacter):l,i="",o.forEach(function(e){i+=e.join(t.columnDelimiter).trim()+"\n"}),a.escapeHTML&&(i=this.stripHTML(i)),a.download&&(i="data:text/plain;charset=utf-8,"+i,this.download(i,t)),i},o.prototype.toCSV=function(t){(t=this.getConfig(t)).type="csv";var i=[],o=[],a=t,c=e.table,s=this.getRows(t);return t.includeHeadings&&(n.each(c.header.cells,function(e){!e.hidden&&a.skipColumns.indexOf(e.index)<0&&(i+=e.content+a.columnDelimiter)}),i=i.trim().substring(0,i.length-1),i+=a.lineDelimiter),n.each(s,function(e,t){o[t]=o[t]||{},n.each(e.cells,function(e,t){!e.hidden&&a.skipColumns.indexOf(e.index)<0&&(i+=e.content+a.columnDelimiter)}),i=i.trim().substring(0,i.length-1),i+=a.lineDelimiter}),i=i.trim().substring(0,i.length-1),a.escapeHTML&&(i=this.stripHTML(i)),a.download&&(i="data:text/csv;charset=utf-8,"+i,this.download(i,t)),i},o.prototype.toJSON=function(t){(t=this.getConfig(t)).type="json";var i="",o=[],a=t,c=e.table,s=this.getRows(t);return n.each(s,function(e,t){o[t]=o[t]||{},n.each(e.cells,function(e,n){!e.hidden&&a.skipColumns.indexOf(e.index)<0&&(o[t][c.header.cells[e.index].content]=s[t].cells[e.index].content)})}),i=JSON.stringify(o,a.replacer,a.space),a.escapeHTML&&(i=this.stripHTML(i)),a.download&&(i="data:application/json;charset=utf-8,"+i,this.download(i,t)),i},o.prototype.toSQL=function(t){(t=this.getConfig(t)).type="sql";var i=t,o=e.table,a=this.getRows(t),c="INSERT INTO `"+i.tableName+"` (";return n.each(o.header.cells,function(e){!e.hidden&&i.skipColumns.indexOf(e.index)<0&&(c+="`"+e.content+"`,")}),c=c.trim().substring(0,c.length-1),c+=") VALUES ",n.each(a,function(e){c+="(",n.each(e.cells,function(e){!e.hidden&&i.skipColumns.indexOf(e.index)<0&&(c+="`"+e.content+"`,")}),c=c.trim().substring(0,c.length-1),c+="),"}),c=c.trim().substring(0,c.length-1),c+=";",i.escapeHTML&&(c=this.stripHTML(c)),i.download&&(c="data:application/sql;charset=utf-8,"+c,this.download(c,t)),c},o.prototype.toXML=function(t){(t=this.getConfig(t)).type="xml";var i,o=this,a=t,c=e.table,s=o.getRows(t),l='<?xml version="1.0" encoding="UTF-8"?><{root}>';return n.each(s,function(e){l+="<{child}>",n.each(e.cells,function(e){i=o.parseXMLTag(c.header.cells[e.index].content),l+="<"+i+">"+(a.escapeHTML?o.stripHTML(e.content):e.content)+"</"+i+">"}),l+="</{child}>"}),l+="</{root}>",l=l.replace(/\{root\}/g,t.rootNode),l=l.replace(/\{child\}/g,t.childNode),a.download&&(l="data:text/xml;charset=utf-8,"+l,this.download(l,t)),l},o.prototype.download=function(e,t){if(e){var n=t.filename||"datatable_export";n+="."+t.type,e=encodeURI(e);var i=document.createElement("a");i.href=e,i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i)}},o.prototype.print=function(t){t&&n.isObject(t)&&(t=n.extend(this.config,t));var i=document.createElement("table"),o=document.createElement("thead"),a=document.createElement("tbody");i.appendChild(o),i.appendChild(a),n.each(e.table.header.cells,function(e){o.appendChild(e.node.cloneNode(!0))}),n.each(e.table.rows,function(e){a.appendChild(e.node.cloneNode(!0))});var c=window.open();c.document.body.appendChild(i),t.modal&&(c.focus(),c.print())},o.prototype.destroy=function(){this.initialised&&(this.initialised=!1)},new o});

// DEMO
const datatable = new DataTable("table", {
	searchable: false,
	perPageSelect: false
});

datatable.on("init", function() {
	document.getElementsByClassName("col-md-12")[1].classList.remove("loading");
});

// Contols
const controls = document.getElementById("controls");
const checkbox = document.getElementById("tostring");

let download = checkbox.checked;

controls.addEventListener("click", exportData, false);
checkbox.addEventListener("change", downloadToggle, false);

function exportData(e) {
	var node = e.target, config = {};
	
	if ( node.nodeName === "BUTTON" ) {
		var method = node.dataset.action;
		
		if ( "args" in  node.dataset ) {
			config = JSON.parse(node.dataset.args);
		}
		
		config.download = download;
		
		console.clear();
		console.log(datatable.exportable[method](config));
	}
}

function downloadToggle(e) {
	download = this.checked;
}